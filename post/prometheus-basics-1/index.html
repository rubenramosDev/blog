<!doctype html><html lang=es dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Monitereo de servicios con Prometheus | 1 | À coder | Rubén Ramos</title><meta name=keywords content="métricas,prometheus,microservicios,monitoreo"><meta name=description content="Introducción, conceptos clave y explicación del funcionamiento de esta herramienta para el monitoreo de servicios."><meta name=author content="Ruben Ramos"><link rel=canonical href=https://rubenramosdev.github.io/blog/post/prometheus-basics-1/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.e507a4ba352192e1c4043e7072b37de616dca81b6f056d4e7f75b2218de34228.css integrity="sha256-5QekujUhkuHEBD5wcrN95hbcqBtvBW1Of3WyIY3jQig=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blog/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://rubenramosdev.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://rubenramosdev.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://rubenramosdev.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://rubenramosdev.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://rubenramosdev.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Monitereo de servicios con Prometheus | 1"><meta property="og:description" content="Introducción, conceptos clave y explicación del funcionamiento de esta herramienta para el monitoreo de servicios."><meta property="og:type" content="article"><meta property="og:url" content="https://rubenramosdev.github.io/blog/post/prometheus-basics-1/"><meta property="og:image" content="https://rubenramosdev.github.io/blog/images/post-1/cover.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-30T11:30:04+03:00"><meta property="article:modified_time" content="2022-07-30T11:30:04+03:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rubenramosdev.github.io/blog/images/post-1/cover.jpg"><meta name=twitter:title content="Monitereo de servicios con Prometheus | 1"><meta name=twitter:description content="Introducción, conceptos clave y explicación del funcionamiento de esta herramienta para el monitoreo de servicios."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://rubenramosdev.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"Monitereo de servicios con Prometheus | 1","item":"https://rubenramosdev.github.io/blog/post/prometheus-basics-1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Monitereo de servicios con Prometheus | 1","name":"Monitereo de servicios con Prometheus | 1","description":"Introducción, conceptos clave y explicación del funcionamiento de esta herramienta para el monitoreo de servicios.","keywords":["métricas","prometheus","microservicios","monitoreo"],"articleBody":"Introducción al monitoreo de aplicaciones, ¿Para qué tomarse la molestia? En el mundo de los microservicios (y en general, en cualquier arquitectura) es de suma importancia conocer el estado de los servicios en funcionamiento.\nCuando menciono estado, me refiero a la capacidad de responder a preguntas del tipo ¿Cuántas peticiones por minuto se reciben?, ¿Cuál es el tiempo de respuesta promedio?, ¿Cuál es el porcentaje de errores por minuto?, ¿Cuál es el endpoint más solicitado?, ¿Cuál es el número de peticiones activas?.\nA la supervisión continua de un conjunto de métricas de rendimiento (o de cualquier tipo), se le conoce como monitoreo de aplicaciones.\nSi bien, el simple hecho de monitorear nuestras aplicaciones no evita que estás puedan colapsar o que los tiempos de respuesta se degraden en ciertas horas del día, sí nos brinda la capacidad de conocer con exactitud cuál es su estado y eventualmente, la capacidad de gestionar nuestro conjunto de servicios mediante la toma de acciones preventivas o correctivas, como puede ser el despliegue de servidores extras en ciertas horas del día o la implementación de un balanceador de carga por monitoreo, etc.\nTodo esto con un objetivo único, garantizar un funcionamiento óptimo e ininterrumpido de nuestros servicios y, naturalmente, una buena experiencia para el usuario final.\nBeneficios del monitoreo Google ha realizado numerosos esfuerzos para propagar la cultura del monitoreo, existen innumerables fuentes de información y documentación generada por ellos mismos, en donde comparten sus experiencias en el área y sus recomendaciones.\nEn esta sección voy a retomar el apartado Why Monitor? del artículo Monitoring Distributed Systems [1]. Extiendo mi amplia recomendación para la consulta de este artículo que es, sin duda, muy enriquecedor.\nMe centraré en 4 puntos claves que considero los más redituables del monitoreo de nuestros servicios:\nAnálisis de tendencias a largo plazo Tener un histórico de un valor nos permite realizar proyecciones del mismo. Por ejemplo, ¿Cuál es la tendencia de ventas de cierto artículo? o ¿Cuál es la proyección de ventas? Realizar comparaciones en diferentes períodos de tiempo ¿Cuál es la cantidad de peticiones recibidas en el mismo período del año pasado? ¿Cuál es la comparativa de ventas en diferentes épocas del año? Análisis retrospectivo de sucesos Supongamos que esperabamos realizar un cierto número de ventas en un fin de semana clave para nuestro negocio pero el objetivo quedó muy por debajo del esperado. ¿Qué sucedió? ¿Nuestros servicios fueron factor? Bueno, gracias al monitereo que estamos realizando podemos analizar el rendimiento de nuestros servicios, saber si estos estuvieron recibiendo un tráfico excesivo que terminó por afectar su rendimiento, otro escenario sería si nuestros proveedores externos experimentaron fallas en su sistema que terminó por afectar a la experiencia de usuario de nuestros clientes y eso, a su vez, al número de ventas. Alertas Retomando el ejemplo anterior, ¿Es necesario esperar a que nuestros sistemas colapsen para poder hacer algo al respecto? La respuesta es un rotundo no. Un gran poder que nos brinda el monitereo es el tema de las Alertas. Gracias al monitoreo, seremos capaces de establecer reglas que nos permitan identificar tendencias dentro de nuestro sistema para poder actuar con antelación. Por ejemplo, si el tiempo de respuesta comienza a degradarse, una alerta llegará a los encargados para que estos puedan desplegar un servicio extra y aliviar el estrés.\nEn un segundo artículo de esta serie, estaré abordando el tema de Alertmanager que es una herramienta de Prometheus cuyo propósito es el de controlar y gestionar las alertas que fijemos en nuestro sistema. Prometheus, el rey del monitoreo. Prometheus es un sistema de monitoreo de código abierto cuyo principal función se centra en recopilar, almacenar y por último, exponer la información de un conjunto de servicios.\nSi bien, esta serie de artículos se centrará en el monitoreo de microservicios, Prometheus puede monitorear cualquier otro servicio capaz de exponer sus métricas, siempre y cuando esta información cuente con un formato específico. Un ejemplo de otros servicios, en donde es posible y sería interesante el monitoreo, es en los servidores Linux, Windows, NGINX o servicios como Kafka o bases de datos como MySQL, SQL Server, etc.\nLa siguiente imagen es un ejemplo del tipo de resultados que se pueden obtener de la mano de Prometheus y Grafana. En donde Prometheus es el encargado de consolidar la información de los servicios y Grafana es el encargado de la parte visual, la generación de gráficos y dashboards. Entendiendo su arquitectura y funcionamiento La siguiente imagen muestra la arquitectura de Prometheus de forma muy general, no obstante, nos ayuda a comprender su funcionamiento interno.\nComo se mencionó anteriormente, Prometheus nos ayuda a recopilar, almacenar y exponer las métricas obtenidas de nuestros servicios. Para entender cómo se lleva a cabo este proceso analicemos la siguiente imagen: Retrival: Es un motor de scrapping encargado de recolectar la información de los diferentes servicios (conocidos como Jobs) que nos interesa monitorear. En un intervalo de tiempo definido por nosotros, por ejemplo, cada 20 segundos, 2 o 5 minutos, este motor se encargará de consultar los servicios registrados para recolectar su información. Los intervalos de tiempo pueden ser generales para todos los Jobs o cada Job puede tener un tiempo particular.\nTime series database o TSDB: Una vez que la información ha sido recolectada, Prometheus almacena la misma en una base de datos de tipo Time series (se explica más adelante). De forma nativa, Prometheus ya cuenta con la integración de una base de datos para almacenar la información de forma local, en disco. No obstante, se pueden integrar alternativas para almacenar la información de forma remota.\nHTTP Server: Prometheus cuenta con un servidor HTTP integrado. Este servidor expone la información previamente recolectada y almacenada por medio de una ruta http, /metrics. Con la información disponible para ser consultada de esta manera, se pueden utilizar múltiples aplicaciones especializadas para la creación de gráficos, como puede ser Grafana.\nMétricas, ¿Qué son? En el sitio oficial de Prometheus, se presenta la siguiente definición:\nIn layperson terms, metrics are numeric measurements. Time series means that changes are recorded over time.\nSin más, una métrica es una medición numérica.\nNo obstante la definición va más allá de eso y nos comienza a introducir un concepto clave de Prometheus y es Time series, en español Serie Temporal. De manera general, una serie temporal es una sucesión de datos que han sido recabados en diferentes momentos y ordenados cronológicamente.\nLa siguiente imagen nos puede ayudar a entender de mejor manera el concepto, se trata de una animación del tipo de gráfica que se puede lograr con una serie temporal: Gracias a la forma en que se recolecta y organiza la información, se puede lograr ver las tendencias o comportamiento de ciertos valores, por ejemplo, el porcentaje de ventas en cierto período del año o el nivel de carga de nuestros servicios en diferentes horas del día, etc.\nFormato de las métricas, ¿Cómo esta compuesta una métrica? Ahora que ya tenemos un contexto más amplio acerca de Prometheus, es momento de entrar en detalles más técnicos. Como fue mencionado anteriormente, Prometheus puede recolectar la información de múltiples servicios, poco importa si se trata de un microservicio o un servidor Linux, la única condición es que esta información tenga un formato específico para que pueda ser interpretada, recolectada y almacenada eventualmente.\nEn la documentación oficial de Prometheus [2], se brinda el siguiente ejemplo para demostrar la composición de una métrica:\n{=, ...} A continuación, vamos a analizar una métrica real que se obtuvo de un microservicio. En este caso, el objetivo de la métrica es dar a conocer el número de peticiones que se encuentran activas en el servidor:\napplication_httprequests_active{server=\"SERVIDOR-EJEMPLO\"} 3 application_httprequests_active: Nombre de la métrica. server=SERVIDOR-EJEMPLO: Este valor es conocido como una etiqueta o label. Una etiqueta es información complementaria para precisar o identificar de mejor manera el origen de la información, adelante veremos más ejemplos. 3 : Valor de la métrica. Con esta métrica, podemos entender que en el servidor con nombre “SERVIDOR-EJEMPLO” se encuentran 3 peticiones activas en el momento en que fue consultado.\nTipos de métricas Prometheus implementa 4 tipos de métricas diferentes para almacenar su información:\nCounter Counter representa el tipo de medición cuyo valor es solamente acumulativo, es decir, incrementa y no disminuye. Ejemplos: Número de peticiones a un servicio, núm. de errores o las ventas de algún producto.\napplication_httprequests_error_rate_per_endpoint_total{route=\"GET\",server=\"SERVIDOR-EJEMPLO\",app=\"NombreDeTuServicio\",env=\"development\"} 2 Gauge Este tipo de métrica representa a un valor que puede incrementar o disminuir de manera arbitraria. Es muy similiar a Counter, con la diferencia de que este valor sí puede disminuir. Ejemplos: Porcentaje de errores por minuto, Núm. de peticiones activas o el uso de memoria de un servicio.\napplication_httprequests_one_minute_error_percentage_rate{server=\"SERVIDOR-EJEMPLO\",app=\"NombreDeTuServicio\",env=\"development\"} 22.126200053643398 Histograms Un histograma es una representación que permite realizar la distribución o categorización de un conjunto de datos. Por ejemplo, con ayuda de un histograma podemos saber cuántos valores fueron bajos, cuántos valores fueron medios y cuántos altos.\nHistogram se utiliza comunmente para monitorear el tamaño de ciertos eventos. Los casos de uso más comunes es para medir el tiempo de las peticiones o el tamaño de la mismas. Este tipo de métrica toma diferentes observaciones de una métrica en diferentes momentos u observe y se colocan en un Bucket. Un bucket es una agrupación de información predefinida por nosotros (para este ejemplo, 10, 20, 50).\nEn Prometheus, los buckets se verían de la siguiente manera: Cada bucket es mayor que el anterior, es decir, sus valores son acumulativos. En este ejemplo, el segundo bucket esta compuesto por la suma de sus valores, más los valores del primero bucket y el tercero, esta compuesto por la suma del segundo y primer bucket.\n_sum y _count por lo general se encuentran presentes en este tipo de métrica. Los 2 campos son valores contadores:\n_count incrementa 1 con cada observe. _sum se incrementa con el valor de la observación obtenida. application_http_request_duration_seconds_bucket{server=\"SERVIDOR-EJEMPLO\", app=\"NombreDeTuServicio\",env=\"development\", handler=\"/\",le=\"0.1\"} 25688 application_http_request_duration_seconds_bucket{server=\"SERVIDOR-EJEMPLO\", app=\"NombreDeTuServicio\",env=\"development\", handler=\"/\",le=\"0.2\"} 23688 application_http_request_duration_seconds_bucket{server=\"SERVIDOR-EJEMPLO\", app=\"NombreDeTuServicio\",env=\"development\", handler=\"/\",le=\"0.4\"} 28782 application_http_request_duration_seconds_bucket{server=\"SERVIDOR-EJEMPLO\", app=\"NombreDeTuServicio\",env=\"development\", handler=\"/\",le=\"+Inf\"} 29000 application_http_request_duration_seconds_sum{server=\"SERVIDOR-EJEMPLO\", app=\"NombreDeTuServicio\",env=\"development\", handler=\"/\"} 1974.90592036741 application_http_request_duration_seconds_count{server=\"SERVIDOR-EJEMPLO\", app=\"NombreDeTuServicio\",env=\"development\", handler=\"/\"} 29020 le significa less than or equal, es decir, igual o menos. Por lo cuál, esta métrica se puede entender:\n25688 peticiones tomaron igual o menos de 100 milisegundos (ms). 23688 peticiones tomaron igual o menos de 200 milisegundos (ms). 28782 peticiones tomaron igual o menos de 400 milisegundos (ms). En total han habido 29020 peticiones. Summary Esta métrica comparte muchas similitudes con Histogram. Se recomienda su uso en los siguientes escenarios:\nCon los Histograms, los quantiles de una métrica son calculados por Prometheus. Con los Summaries, estos valores son calculados en lado del cliente. Si no se tiene una idea clara sobre las definiciones de los buckets o como segmentar un valor, Summary es mejor alternativa, debido a que los histograms necesitan de definiciones de buckets de manera forzosa. Recomiendo consultar la documentación de Prometheus en dónde se aborda el tema a detalle.\n¿Qué monitorear? ¿Cómo? ¿Cuándo? - The Four Golden Signals ¿Es realmente importante monitorear el nombre de un servidor? O, ¿El nombre de los endpoints? Quizás sí o quizás no, algunas métricas tendrán más sentido para una organización que para otra, lo importante entonces es diseñar un plan de monitoreo en dónde se defina claramente: ¿Qué se va a monitorear y para qué? Es de suma importancia, sobre todo si se estará recopilando información que atañe a diferentes áreas, como por ejemplo, el número de ventas de un producto, el número de fallas de los proveedores externos o el tiempo de respuesta de un determinado endpoint, si bien, estos valores pueden estar relacionados, su información y atención no necesariamente pertenece a la misma área dentro de una organización.\nEn esta sección me remito de nueva cuenta al artículo Monitoring Distributed Systems [1] en donde se plantean 4 puntos fundamentales que deben ser considerados sí o sí en el monitoreo de nuestros sistemas.\nLatencia\n¿En cuánto tiempo se están resolviendo las peticiones del cliente? El artículo menciona algo clave, es importante tener cuidado y fijar un sesgo muy claro en este punto, ¡ Los posibles errores que se generen en nuestro sistema no forman parte de la latencia del mismo ! Si nuestro sistema responde en ocasiones con una rapidez de 10ms porque se esta presentando un error, esto no quiere decir que sea rápido 😅. Tráfico\n¿Cuál es el número de peticiones que esta recibiendo nuestro sistema? ¿Cuál es el promedio por minuto? Errores\n¿Cuántos errores se están generando? ¿Cuál es la tasa de error por minuto? Saturación\n¿Qué tanta carga tiene el sistema? ¿Qué tan saturado se encuentra? Hasta aquí el contenido de esta serie de artículos. En un siguiente artículo se estará cubriendo temas más técnicos de Prometheus como PromQL, el archivo de configuración y Alertmanager, entre otros temas.\nReferencias [1] Monitoring Distributed Systems by Rob Ewaschuk\n[2] Histograms and summaries\n[3] Data model\n","wordCount":"2139","inLanguage":"es","image":"https://rubenramosdev.github.io/blog/images/post-1/cover.jpg","datePublished":"2022-07-30T11:30:04+03:00","dateModified":"2022-07-30T11:30:04+03:00","author":{"@type":"Person","name":"Ruben Ramos"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rubenramosdev.github.io/blog/post/prometheus-basics-1/"},"publisher":{"@type":"Organization","name":"À coder | Rubén Ramos","logo":{"@type":"ImageObject","url":"https://rubenramosdev.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://rubenramosdev.github.io/blog/ accesskey=h title="À coder | (Alt + H)">À coder |</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://rubenramosdev.github.io/blog/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://rubenramosdev.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://rubenramosdev.github.io/blog/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://rubenramosdev.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://rubenramosdev.github.io/blog/about-me/ title="About me"><span>About me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://rubenramosdev.github.io/blog/>Inicio</a>&nbsp;»&nbsp;<a href=https://rubenramosdev.github.io/blog/posts/>Posts</a></div><h1 class=post-title>Monitereo de servicios con Prometheus | 1</h1><div class=post-meta><span title='2022-07-30 11:30:04 +0300 +0300'>julio 30, 2022</span>&nbsp;·&nbsp;Ruben Ramos</div></header><figure class=entry-cover><img loading=lazy src=https://rubenramosdev.github.io/blog/images/post-1/cover.jpg alt="primer vistazo a Prometheus."></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Tabla de Contenidos</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#introducción-al-monitoreo-de-aplicaciones-para-qué-tomarse-la-molestia>Introducción al monitoreo de aplicaciones, ¿Para qué tomarse la molestia?</a><ul><li><a href=#beneficios-del-monitoreo>Beneficios del monitoreo</a></li></ul></li><li><a href=#prometheus-el-rey-del-monitoreo>Prometheus, el rey del monitoreo.</a></li><li><a href=#entendiendo-su-arquitectura-y-funcionamiento>Entendiendo su arquitectura y funcionamiento</a></li><li><a href=#métricas-qué-son>Métricas, ¿Qué son?</a><ul><li><a href=#formato-de-las-métricas-cómo-esta-compuesta-una-métrica>Formato de las métricas, ¿Cómo esta compuesta una métrica?</a></li></ul></li><li><a href=#tipos-de-métricas>Tipos de métricas</a><ul><li><a href=#counter>Counter</a></li><li><a href=#gauge>Gauge</a></li><li><a href=#histograms>Histograms</a></li><li><a href=#summary>Summary</a></li></ul></li><li><a href=#qué-monitorear-cómo-cuándo---the-four-golden-signals>¿Qué monitorear? ¿Cómo? ¿Cuándo? - The Four Golden Signals</a></li><li><a href=#referencias>Referencias</a></li></ul></nav></div></details></div><div class=post-content><h2 id=introducción-al-monitoreo-de-aplicaciones-para-qué-tomarse-la-molestia>Introducción al monitoreo de aplicaciones, ¿Para qué tomarse la molestia?<a hidden class=anchor aria-hidden=true href=#introducción-al-monitoreo-de-aplicaciones-para-qué-tomarse-la-molestia>#</a></h2><p>En el mundo de los microservicios <em>(y en general, en cualquier arquitectura)</em> es de suma importancia conocer el estado de los servicios en funcionamiento.</p><p>Cuando menciono estado, me refiero a la capacidad de responder a preguntas del tipo ¿Cuántas peticiones por minuto se reciben?, ¿Cuál es el tiempo de respuesta promedio?, ¿Cuál es el porcentaje de errores por minuto?, ¿Cuál es el endpoint más solicitado?, ¿Cuál es el número de peticiones activas?.</p><p>A la supervisión continua de un conjunto de métricas de rendimiento <em>(o de cualquier tipo)</em>, se le conoce como <strong>monitoreo de aplicaciones</strong>.</p><p>Si bien, el simple hecho de monitorear nuestras aplicaciones no evita que estás puedan colapsar o que los tiempos de respuesta se degraden en ciertas horas del día, <strong>sí nos brinda la capacidad de conocer con exactitud cuál es su estado</strong> y eventualmente, la capacidad de <strong>gestionar nuestro conjunto de servicios</strong> mediante la toma de acciones preventivas o correctivas, como puede ser el despliegue de servidores extras en ciertas horas del día o la implementación de un balanceador de carga por monitoreo, etc.</p><p>Todo esto con un objetivo único, <strong>garantizar un funcionamiento óptimo e ininterrumpido de nuestros servicios y, naturalmente, una buena experiencia para el usuario final.</strong></p><h3 id=beneficios-del-monitoreo>Beneficios del monitoreo<a hidden class=anchor aria-hidden=true href=#beneficios-del-monitoreo>#</a></h3><p>Google ha realizado numerosos esfuerzos para propagar la cultura del monitoreo, existen innumerables fuentes de información y documentación generada por ellos mismos, en donde comparten sus experiencias en el área y sus recomendaciones.</p><p>En esta sección voy a retomar el apartado Why Monitor? del artículo Monitoring Distributed Systems [1]. Extiendo mi amplia recomendación para la consulta de este artículo que es, sin duda, muy enriquecedor.</p><p>Me centraré en 4 puntos claves que considero los más redituables del monitoreo de nuestros servicios:</p><ul><li><strong>Análisis de tendencias a largo plazo</strong><ul><li>Tener un histórico de un valor nos permite realizar proyecciones del mismo. Por ejemplo, ¿Cuál es la tendencia de ventas de cierto artículo? o ¿Cuál es la proyección de ventas?</li></ul></li><li><strong>Realizar comparaciones en diferentes períodos de tiempo</strong><ul><li>¿Cuál es la cantidad de peticiones recibidas en el mismo período del año pasado? ¿Cuál es la comparativa de ventas en diferentes épocas del año?</li></ul></li><li><strong>Análisis retrospectivo de sucesos</strong><ul><li>Supongamos que esperabamos realizar un cierto número de ventas en un fin de semana clave para nuestro negocio pero el objetivo quedó muy por debajo del esperado. ¿Qué sucedió? ¿Nuestros servicios fueron factor? Bueno, gracias al monitereo que estamos realizando podemos analizar el rendimiento de nuestros servicios, saber si estos estuvieron recibiendo un tráfico excesivo que terminó por afectar su rendimiento, otro escenario sería si nuestros proveedores externos experimentaron fallas en su sistema que terminó por afectar a la experiencia de usuario de nuestros clientes y eso, a su vez, al número de ventas.</li></ul></li><li><strong>Alertas</strong><ul><li>Retomando el ejemplo anterior, ¿Es necesario esperar a que nuestros sistemas colapsen para poder hacer algo al respecto? <strong>La respuesta es un rotundo no.</strong> Un gran poder que nos brinda el monitereo es el tema de las Alertas. Gracias al monitoreo, seremos capaces de establecer reglas que nos permitan identificar tendencias dentro de nuestro sistema para poder actuar con antelación. Por ejemplo, si el tiempo de respuesta comienza a degradarse, una alerta llegará a los encargados para que estos puedan desplegar un servicio extra y aliviar el estrés.<br>En un segundo artículo de esta serie, estaré abordando el tema de <strong>Alertmanager</strong> que es una herramienta de Prometheus cuyo propósito es el de controlar y gestionar las alertas que fijemos en nuestro sistema.</li></ul></li></ul><h2 id=prometheus-el-rey-del-monitoreo>Prometheus, el rey del monitoreo.<a hidden class=anchor aria-hidden=true href=#prometheus-el-rey-del-monitoreo>#</a></h2><p>Prometheus es un <strong>sistema de monitoreo de código abierto</strong> cuyo principal función se centra en <strong>recopilar, almacenar y por último, exponer</strong> la información de un conjunto de servicios.</p><p>Si bien, esta serie de artículos se centrará en el monitoreo de microservicios, Prometheus puede monitorear <strong>cualquier otro servicio capaz de exponer sus métricas</strong>, siempre y cuando esta información cuente con un <strong>formato específico</strong>. Un ejemplo de otros servicios, en donde es posible y sería interesante el monitoreo, es en los servidores Linux, Windows, NGINX o servicios como Kafka o bases de datos como MySQL, SQL Server, etc.</p><p>La siguiente imagen es un ejemplo del tipo de resultados que se pueden obtener de la mano de Prometheus y Grafana. En donde Prometheus es el encargado de consolidar la información de los servicios y Grafana es el encargado de la parte visual, la generación de gráficos y dashboards.
<img loading=lazy src=https://miro.medium.com/max/1312/1*dzODOIDqXTsWauf5eM8Trw.gif#center alt=ejemplo-métricas></p><h2 id=entendiendo-su-arquitectura-y-funcionamiento>Entendiendo su arquitectura y funcionamiento<a hidden class=anchor aria-hidden=true href=#entendiendo-su-arquitectura-y-funcionamiento>#</a></h2><p>La siguiente imagen muestra la arquitectura de Prometheus de forma muy general, no obstante, nos ayuda a comprender su funcionamiento interno.</p><p>Como se mencionó anteriormente, Prometheus nos ayuda a <strong>recopilar, almacenar y exponer</strong> las métricas obtenidas de nuestros servicios. Para entender cómo se lleva a cabo este proceso analicemos la siguiente imagen:
<img loading=lazy src=/images/post-1/promethus-architecture.jpg#center alt=arquitectura-básica-Prometheus></p><ol><li><p><strong>Retrival</strong>: Es un motor de <em>scrapping</em> encargado de <strong>recolectar</strong> la información de los diferentes servicios <em>(conocidos como Jobs)</em> que nos interesa monitorear. En un intervalo de tiempo definido por nosotros, por ejemplo, cada 20 segundos, 2 o 5 minutos, este motor se encargará de consultar los servicios registrados para recolectar su información. Los intervalos de tiempo pueden ser generales para todos los <em>Jobs</em> o cada <em>Job</em> puede tener un tiempo particular.</p></li><li><p><strong>Time series database o TSDB</strong>: Una vez que la información ha sido recolectada, Prometheus <strong>almacena</strong> la misma en una base de datos de tipo <strong>Time series</strong> <em>(se explica más adelante)</em>. De forma nativa, Prometheus ya cuenta con la integración de una base de datos para almacenar la información de forma local, en disco. No obstante, se pueden integrar alternativas para almacenar la información de forma remota.</p></li><li><p><strong>HTTP Server</strong>: Prometheus cuenta con un servidor HTTP integrado. Este servidor <strong>expone</strong> la información previamente recolectada y almacenada por medio de una ruta http, <em>/metrics</em>. Con la información disponible para ser consultada de esta manera, se pueden utilizar múltiples aplicaciones especializadas para la creación de gráficos, como puede ser Grafana.</p></li></ol><h2 id=métricas-qué-son>Métricas, ¿Qué son?<a hidden class=anchor aria-hidden=true href=#métricas-qué-son>#</a></h2><p>En el sitio oficial de Prometheus, se presenta la siguiente definición:</p><blockquote><p>In layperson terms, metrics are numeric measurements. Time series means that changes are recorded over time.</p></blockquote><p>Sin más, <strong>una métrica es una medición numérica.</strong></p><p>No obstante la definición va más allá de eso y nos comienza a introducir un concepto clave de Prometheus y es <strong>Time series</strong>, en español <strong>Serie Temporal</strong>. De manera general, una serie temporal es una sucesión de datos que han sido recabados en diferentes momentos y ordenados cronológicamente.</p><p>La siguiente imagen nos puede ayudar a entender de mejor manera el concepto, se trata de una animación del tipo de gráfica que se puede lograr con una serie temporal:
<img loading=lazy src=https://media.giphy.com/media/rM0wxzvwsv5g4/giphy.gif#center alt=gráfica-con-datos-series-temporal></p><p>Gracias a la forma en que se recolecta y organiza la información, se puede lograr ver las tendencias o comportamiento de ciertos valores, por ejemplo, el porcentaje de ventas en cierto período del año o el nivel de carga de nuestros servicios en diferentes horas del día, etc.</p><h3 id=formato-de-las-métricas-cómo-esta-compuesta-una-métrica>Formato de las métricas, ¿Cómo esta compuesta una métrica?<a hidden class=anchor aria-hidden=true href=#formato-de-las-métricas-cómo-esta-compuesta-una-métrica>#</a></h3><p>Ahora que ya tenemos un contexto más amplio acerca de Prometheus, es momento de entrar en detalles más técnicos. Como fue mencionado anteriormente, Prometheus puede recolectar la información de múltiples servicios, poco importa si se trata de un microservicio o un servidor Linux, la única condición es que esta información tenga un formato específico para que pueda ser interpretada, recolectada y almacenada eventualmente.</p><p>En la documentación oficial de Prometheus [2], se brinda el siguiente ejemplo para demostrar la composición de una métrica:</p><pre tabindex=0><code>&lt;nombre de la métrica&gt;{&lt;nombre etiqueta&gt;=&lt;valor de la etiqueta&gt;, ...}
</code></pre><p>A continuación, vamos a analizar una métrica real que se obtuvo de un microservicio. En este caso, el objetivo de la métrica es dar a conocer el número de peticiones que se encuentran activas en el servidor:</p><pre tabindex=0><code>application_httprequests_active{server=&#34;SERVIDOR-EJEMPLO&#34;} 3
</code></pre><ul><li><strong>application_httprequests_active</strong>: Nombre de la métrica.</li><li><strong>server=SERVIDOR-EJEMPLO</strong>: Este valor es conocido como una <strong>etiqueta o label</strong>. Una etiqueta es información complementaria para precisar o identificar de mejor manera el origen de la información, adelante veremos más ejemplos.</li><li><strong>3</strong> : Valor de la métrica.</li></ul><p>Con esta métrica, podemos entender que <strong>en el servidor con nombre &ldquo;SERVIDOR-EJEMPLO&rdquo; se encuentran 3 peticiones activas en el momento en que fue consultado.</strong></p><h2 id=tipos-de-métricas>Tipos de métricas<a hidden class=anchor aria-hidden=true href=#tipos-de-métricas>#</a></h2><p>Prometheus implementa 4 tipos de métricas diferentes para almacenar su información:</p><h3 id=counter>Counter<a hidden class=anchor aria-hidden=true href=#counter>#</a></h3><p>Counter representa el tipo de medición cuyo valor es solamente acumulativo, es decir, <strong>incrementa y no disminuye</strong>. Ejemplos: <em>Número de peticiones a un servicio, núm. de errores o las ventas de algún producto.</em></p><pre tabindex=0><code>application_httprequests_error_rate_per_endpoint_total{route=&#34;GET&#34;,server=&#34;SERVIDOR-EJEMPLO&#34;,app=&#34;NombreDeTuServicio&#34;,env=&#34;development&#34;} 2
</code></pre><h3 id=gauge>Gauge<a hidden class=anchor aria-hidden=true href=#gauge>#</a></h3><p>Este tipo de métrica representa a un valor que puede <strong>incrementar o disminuir</strong> de manera arbitraria. Es muy similiar a <em>Counter</em>, con la diferencia de que este valor <strong>sí puede disminuir</strong>. Ejemplos: <em>Porcentaje de errores por minuto, Núm. de peticiones activas o el uso de memoria de un servicio</em>.</p><pre tabindex=0><code>application_httprequests_one_minute_error_percentage_rate{server=&#34;SERVIDOR-EJEMPLO&#34;,app=&#34;NombreDeTuServicio&#34;,env=&#34;development&#34;} 22.126200053643398
</code></pre><h3 id=histograms>Histograms<a hidden class=anchor aria-hidden=true href=#histograms>#</a></h3><p>Un histograma es una representación que permite realizar la distribución o categorización de un conjunto de datos. Por ejemplo, con ayuda de un histograma podemos saber cuántos valores fueron bajos, cuántos valores fueron medios y cuántos altos.</p><p>Histogram se utiliza comunmente para monitorear el tamaño de ciertos eventos. Los casos de uso más comunes es para medir el tiempo de las peticiones o el tamaño de la mismas. Este tipo de métrica toma diferentes observaciones de una métrica en diferentes <em>momentos u observe</em> y se colocan en un <strong>Bucket</strong>. Un bucket es una agrupación de información predefinida por nosotros <em>(para este ejemplo, 10, 20, 50).</em></p><p>En Prometheus, los buckets se verían de la siguiente manera:
<img loading=lazy src=/images/post-1/grafica.png#center alt=arquitectura-básica-Prometheus></p><p>Cada bucket es mayor que el anterior, es decir, sus valores son acumulativos. En este ejemplo, el segundo bucket esta compuesto por la suma de sus valores, más los valores del primero bucket y el tercero, esta compuesto por la suma del segundo y primer bucket.</p><p><strong>_sum</strong> y <strong>_count</strong> por lo general se encuentran presentes en este tipo de métrica. Los 2 campos son valores contadores:</p><ul><li>_count incrementa 1 con cada observe.</li><li>_sum se incrementa con el valor de la observación obtenida.</li></ul><pre tabindex=0><code>application_http_request_duration_seconds_bucket{server=&#34;SERVIDOR-EJEMPLO&#34;, app=&#34;NombreDeTuServicio&#34;,env=&#34;development&#34;, handler=&#34;/&#34;,le=&#34;0.1&#34;} 25688
application_http_request_duration_seconds_bucket{server=&#34;SERVIDOR-EJEMPLO&#34;, app=&#34;NombreDeTuServicio&#34;,env=&#34;development&#34;, handler=&#34;/&#34;,le=&#34;0.2&#34;} 23688
application_http_request_duration_seconds_bucket{server=&#34;SERVIDOR-EJEMPLO&#34;, app=&#34;NombreDeTuServicio&#34;,env=&#34;development&#34;, handler=&#34;/&#34;,le=&#34;0.4&#34;} 28782
application_http_request_duration_seconds_bucket{server=&#34;SERVIDOR-EJEMPLO&#34;, app=&#34;NombreDeTuServicio&#34;,env=&#34;development&#34;, handler=&#34;/&#34;,le=&#34;+Inf&#34;} 29000
application_http_request_duration_seconds_sum{server=&#34;SERVIDOR-EJEMPLO&#34;, app=&#34;NombreDeTuServicio&#34;,env=&#34;development&#34;, handler=&#34;/&#34;} 1974.90592036741
application_http_request_duration_seconds_count{server=&#34;SERVIDOR-EJEMPLO&#34;, app=&#34;NombreDeTuServicio&#34;,env=&#34;development&#34;, handler=&#34;/&#34;} 29020
</code></pre><p><strong>le</strong> significa <em>less than or equal</em>, es decir, igual o menos. Por lo cuál, esta métrica se puede entender:</p><ul><li>25688 peticiones tomaron igual o menos de 100 milisegundos (ms).</li><li>23688 peticiones tomaron igual o menos de 200 milisegundos (ms).</li><li>28782 peticiones tomaron igual o menos de 400 milisegundos (ms).</li><li>En total han habido 29020 peticiones.</li></ul><h3 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h3><p>Esta métrica comparte muchas similitudes con Histogram. Se recomienda su uso en los siguientes escenarios:</p><ul><li>Con los Histograms, los quantiles de una métrica son calculados por Prometheus. Con los Summaries, estos valores son calculados en lado del cliente.</li><li>Si no se tiene una idea clara sobre las definiciones de los buckets o como segmentar un valor, Summary es mejor alternativa, debido a que los histograms necesitan de definiciones de buckets de manera forzosa.</li></ul><p>Recomiendo consultar la <a href=https://prometheus.io/docs/practices/histograms/>documentación de Prometheus en dónde se aborda el tema a detalle.</a></p><h2 id=qué-monitorear-cómo-cuándo---the-four-golden-signals>¿Qué monitorear? ¿Cómo? ¿Cuándo? - The Four Golden Signals<a hidden class=anchor aria-hidden=true href=#qué-monitorear-cómo-cuándo---the-four-golden-signals>#</a></h2><p>¿Es realmente importante monitorear el nombre de un servidor? O, ¿El nombre de los endpoints? Quizás sí o quizás no, algunas métricas tendrán más sentido para una organización que para otra, lo importante entonces es diseñar un plan de monitoreo en dónde se defina claramente: ¿Qué se va a monitorear y para qué? Es de suma importancia, sobre todo si se estará recopilando información que atañe a diferentes áreas, como por ejemplo, el número de ventas de un producto, el número de fallas de los proveedores externos o el tiempo de respuesta de un determinado endpoint, si bien, estos valores pueden estar relacionados, su información y atención no necesariamente pertenece a la misma área dentro de una organización.</p><p>En esta sección me remito de nueva cuenta al artículo Monitoring Distributed Systems [1] en donde se plantean 4 puntos fundamentales que deben ser considerados sí o sí en el monitoreo de nuestros sistemas.</p><ul><li><p><strong>Latencia</strong></p><ul><li>¿En cuánto tiempo se están resolviendo las peticiones del cliente? El artículo menciona algo clave, es importante tener cuidado y fijar un sesgo muy claro en este punto, <strong>¡ Los posibles errores que se generen en nuestro sistema no forman parte de la latencia del mismo !</strong> Si nuestro sistema responde en ocasiones con una rapidez de 10ms porque se esta presentando un error, esto no quiere decir que sea rápido 😅.</li></ul></li><li><p><strong>Tráfico</strong></p><ul><li>¿Cuál es el número de peticiones que esta recibiendo nuestro sistema? ¿Cuál es el promedio por minuto?</li></ul></li><li><p><strong>Errores</strong></p><ul><li>¿Cuántos errores se están generando? ¿Cuál es la tasa de error por minuto?</li></ul></li><li><p><strong>Saturación</strong></p><ul><li>¿Qué tanta carga tiene el sistema? ¿Qué tan saturado se encuentra?</li></ul></li></ul><p>Hasta aquí el contenido de esta serie de artículos. En un siguiente artículo se estará cubriendo temas más técnicos de Prometheus como PromQL, el archivo de configuración y Alertmanager, entre otros temas.</p><h2 id=referencias>Referencias<a hidden class=anchor aria-hidden=true href=#referencias>#</a></h2><blockquote><p>[1] <a href=https://sre.google/sre-book/monitoring-distributed-systems/>Monitoring Distributed Systems by Rob Ewaschuk</a><br>[2] <a href=https://prometheus.io/docs/practices/histograms/>Histograms and summaries</a><br>[3] <a href=https://prometheus.io/docs/concepts/data_model/>Data model</a></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://rubenramosdev.github.io/blog/tags/m%C3%A9tricas/>métricas</a></li><li><a href=https://rubenramosdev.github.io/blog/tags/prometheus/>prometheus</a></li><li><a href=https://rubenramosdev.github.io/blog/tags/microservicios/>microservicios</a></li><li><a href=https://rubenramosdev.github.io/blog/tags/monitoreo/>monitoreo</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Monitereo de servicios con Prometheus | 1 on twitter" href="https://twitter.com/intent/tweet/?text=Monitereo%20de%20servicios%20con%20Prometheus%20%7c%201&url=https%3a%2f%2frubenramosdev.github.io%2fblog%2fpost%2fprometheus-basics-1%2f&hashtags=m%c3%a9tricas%2cprometheus%2cmicroservicios%2cmonitoreo"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Monitereo de servicios con Prometheus | 1 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2frubenramosdev.github.io%2fblog%2fpost%2fprometheus-basics-1%2f&title=Monitereo%20de%20servicios%20con%20Prometheus%20%7c%201&summary=Monitereo%20de%20servicios%20con%20Prometheus%20%7c%201&source=https%3a%2f%2frubenramosdev.github.io%2fblog%2fpost%2fprometheus-basics-1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Monitereo de servicios con Prometheus | 1 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2frubenramosdev.github.io%2fblog%2fpost%2fprometheus-basics-1%2f&title=Monitereo%20de%20servicios%20con%20Prometheus%20%7c%201"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Monitereo de servicios con Prometheus | 1 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frubenramosdev.github.io%2fblog%2fpost%2fprometheus-basics-1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Monitereo de servicios con Prometheus | 1 on whatsapp" href="https://api.whatsapp.com/send?text=Monitereo%20de%20servicios%20con%20Prometheus%20%7c%201%20-%20https%3a%2f%2frubenramosdev.github.io%2fblog%2fpost%2fprometheus-basics-1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Monitereo de servicios con Prometheus | 1 on telegram" href="https://telegram.me/share/url?text=Monitereo%20de%20servicios%20con%20Prometheus%20%7c%201&url=https%3a%2f%2frubenramosdev.github.io%2fblog%2fpost%2fprometheus-basics-1%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>